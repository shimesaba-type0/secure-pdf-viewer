# TASK-020: 管理者権限フロントエンド実装

## 概要
TASK-019の管理者権限システムのフロントエンド部分を実装します。管理画面に管理者管理機能を追加し、直感的なUIで管理者の追加・削除・管理が行えるようにします。

## 背景・目的
- 管理者が簡単に他の管理者を管理できるUI提供
- 管理者権限の可視化
- セキュリティ上の操作を安全に行えるインターフェース

## 要件

### UI要件
1. **管理者管理タブ**
   - 管理画面に「管理者管理」タブを追加
   - 現在ログイン中の管理者情報を表示

2. **管理者一覧**
   - 全管理者の一覧表示
   - メールアドレス、追加日時、追加者、ステータス表示
   - 有効/無効の切り替えボタン

3. **管理者追加フォーム**
   - メールアドレス入力フィールド
   - 追加ボタン
   - バリデーション（メール形式、重複チェック）
   - 最大人数チェック（6人まで）

4. **管理者削除機能**
   - 削除確認ダイアログ
   - 最後の管理者は削除不可の制御
   - 削除理由の入力（オプション）

### UX要件
1. **レスポンシブデザイン**
   - モバイル対応
   - 既存の管理画面デザインとの統一

2. **エラーハンドリング**
   - わかりやすいエラーメッセージ
   - 成功/失敗の通知

3. **セキュリティ確認**
   - 重要な操作前の確認ダイアログ
   - 操作結果の明確な表示

### 技術仕様

#### HTML構造 (admin.html)
```html
<div id="admin-users-tab" class="tab-content">
    <div class="admin-users-header">
        <h3>管理者管理</h3>
        <div class="current-admin-info">
            現在のログイン: <span id="current-admin-email"></span>
        </div>
    </div>
    
    <div class="admin-users-actions">
        <button id="add-admin-btn" class="btn btn-primary">管理者を追加</button>
        <span class="admin-count">管理者数: <span id="admin-count"></span>/6</span>
    </div>
    
    <div class="admin-users-list">
        <table id="admin-users-table">
            <thead>
                <tr>
                    <th>メールアドレス</th>
                    <th>追加日時</th>
                    <th>追加者</th>
                    <th>ステータス</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody id="admin-users-tbody">
            </tbody>
        </table>
    </div>
</div>
```

#### JavaScript機能 (admin.js)
```javascript
// 管理者管理関連の関数
const AdminUserManagement = {
    loadAdminUsers: function() {},
    addAdminUser: function(email) {},
    toggleAdminStatus: function(id, isActive) {},
    deleteAdminUser: function(id) {},
    showAddAdminModal: function() {},
    showDeleteConfirmModal: function(id, email) {}
};
```

#### CSS スタイル
- 既存の管理画面スタイルとの統一
- テーブルスタイル
- モーダルダイアログスタイル
- ボタンスタイル

### API連携
1. **管理者一覧取得**
   - `GET /admin/api/users`
   - レスポンス: 管理者情報配列

2. **管理者追加**
   - `POST /admin/api/users`
   - パラメータ: email
   - バリデーション結果を返す

3. **管理者ステータス更新**
   - `PUT /admin/api/users/<id>`
   - パラメータ: is_active

4. **管理者削除**
   - `DELETE /admin/api/users/<id>`
   - 確認処理後に削除実行

### 成功基準（TASK-019で実装済み）
- [x] 管理画面に「管理者管理」タブが表示される
- [x] 管理者一覧が正しく表示される
- [x] 新しい管理者を追加できる
- [x] 管理者の有効/無効を切り替えできる
- [x] 管理者を削除できる（最後の一人は除く）
- [x] エラーが適切に表示される
- [x] モバイルでも操作できる
- [x] 操作後に一覧が自動更新される

### セキュリティ要件（TASK-019で実装済み）
- [x] 管理者権限がないユーザーはタブ自体が表示されない
- [x] 重要な操作には確認ダイアログを表示
- [x] XSS対策（入力値のエスケープ）
- [x] CSRF対策（既存のトークン利用）

## 実装ファイル
1. **templates/admin.html**
   - 管理者管理タブの追加
   - モーダルダイアログの追加

2. **static/js/admin.js**
   - 管理者管理機能の実装
   - API呼び出し処理

3. **static/css/main.css**
   - 管理者管理用スタイル追加

## テストケース
1. **基本操作テスト**
   - [ ] 管理者一覧の表示
   - [ ] 管理者追加機能
   - [ ] ステータス切り替え機能
   - [ ] 削除機能

2. **バリデーションテスト**
   - [ ] 無効なメールアドレスの拒否
   - [ ] 重複メールアドレスの拒否
   - [ ] 最大人数超過の拒否

3. **セキュリティテスト**
   - [ ] 管理者権限のないユーザーからのアクセス拒否
   - [ ] XSS攻撃の防止

## 関連チケット
- TASK-019: 管理者権限システムの実装（バックエンド）

## 完了予定日
2025-07-30

## ステータス
- [x] 要件定義完了
- [x] 実装状況確認完了（TASK-019で既に全機能実装済み）
- [x] 完了

## 実装状況
**TASK-019で既に完全実装済み：**
- [x] 管理画面に「管理者管理」タブが表示される
- [x] 管理者一覧が正しく表示される
- [x] 新しい管理者を追加できる
- [x] 管理者の有効/無効を切り替えできる
- [x] 管理者を削除できる（最後の一人は除く）
- [x] エラーが適切に表示される
- [x] モバイルでも操作できる
- [x] 操作後に一覧が自動更新される
- [x] 管理者権限がないユーザーはタブ自体が表示されない
- [x] 重要な操作には確認ダイアログを表示
- [x] XSS対策（入力値のエスケープ）
- [x] CSRF対策（既存のトークン利用）