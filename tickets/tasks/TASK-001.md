# TASK-001: 2段階認証（メール）システム実装

**フェーズ**: [Phase 1: 認証システム完成](../phases/phase1-authentication.md)  
**優先度**: 🔴 高優先度  
**状況**: 🔄 進行中  
**担当者**: TBD  
**作成日**: 2025-07-18

## 概要
事前共有パスフレーズ認証後のメール認証システムを実装し、2段階認証を完成させる。

## 要件
1. メールアドレス入力画面の実装
2. OTP生成・送信機能
3. OTP検証機能
4. 認証完了・セッション確立

## 実装対象
- `GET /auth/send-otp` - メールアドレス入力画面
- `POST /auth/send-otp` - OTP送信処理
- `GET /auth/verify-otp` - OTP入力画面
- `POST /auth/verify-otp` - OTP確認・認証完了

## 成功条件
- [ ] メールアドレス入力フォームの実装
- [x] OTP生成・送信機能（6桁数字、10分有効期限） ✅ 2025-07-19完了
- [ ] OTP検証機能の実装
- [ ] 認証完了後のセッション確立
- [ ] エラーハンドリング（無効OTP、期限切れ等）

## 技術的詳細
- **OTP生成**: 6桁ランダム数字
- **有効期限**: 10分
- **メール送信**: SMTPライブラリ使用
- **データベース**: otp_tokens テーブル追加

## 見積もり
- **工数**: 2-3日
- **完了予定**: 2025年7月下旬